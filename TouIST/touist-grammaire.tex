%\renewcommand{\textless}[1]{\bf$\langle$}
%\renewcommand{\textgreater}[1]{$\rangle$}
%\renewcommand{\mdcolor}[1]{}

\noindent Nous présentons ici la grammaire de TouIST sous forme BNF. Certaines règles (une règle commence avec "\mdcode{::=}\textquotedblleft{}) sont paramétrées de telle sorte que des parties de la grammaire soient factorisées (l'idée de règles paramétrées provient du parser \emph{Menhir} que nous avons utilisé pour développer le parser de \touist.%mdk

\noindent\textbf{Remarque}.
Cette grammaire n'est pas LR(1) et ne peut être implémentée telle quelle en utilisant \emph{Menhir} ; une large part de la vérification de type est réalisée après la production de l'arbre de syntaxe abstraite. L'objectif de cette spécification est de présenter de la manière la plus claire et la plus synthétique possible ce que le langage de \touist permet ou non d'exprimer.%mdk%mdk

\begin{footnotesize}

\begin{mdpre}%mdk
\noindent INT~~~~~~~=~{}[0-9]+\\
FLOAT~~~~~=~{}[0-9]+\textbackslash{}.{}[0-9]+\\
TERM~~~~~~=~{}[\_0-9]*{}[a-zA-Z]{}[a-zA-Z\_0-9]*%mdk
\end{mdpre}\begin{mdpre}%mdk
\noindent{\mdcolor{purple}\textless{}touist-file\textgreater{}}~::=~{\mdcolor{purple}\textless{}assign\textgreater{}}~{\mdcolor{purple}\textless{}touist-file\textgreater{}}\\
~~~~~~~~~~~~~~~~~\textbar{}~{\mdcolor{purple}\textless{}formula\textgreater{}}~{\mdcolor{purple}\textless{}touist-file\textgreater{}}\\
~~~~~~~~~~~~~~~~~\textbar{}~EOF\\
\\
{\mdcolor{purple}\textless{}expr\textgreater{}}~::=~{\mdcolor{purple}\textless{}int\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}float\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}prop\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}bool\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}set\textgreater{}}\\
~~~~\textbar{}~"""{\mdcolor{purple}\textless{}formula-simple\textgreater{}}"""~~{\mdcolor{darkgreen}\textless{}-~Touist~\textgreater{}=~3.5.1}\\
{\mdcolor{purple}\textless{}var\textgreater{}}~::=~"\$"~TERM\\
~~~~\textbar{}~"\$"~TERM~"("~{\mdcolor{purple}\textless{}comma-list(\textless{}expr\textgreater{})\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}prop\textgreater{}}~::=\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~TERM\\
~~~~\textbar{}~TERM~"("~{\mdcolor{purple}\textless{}comma-list(\textless{}expr\textgreater{})\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}assign\textgreater{}}~::=~{\mdcolor{purple}\textless{}var\textgreater{}}~"="~({\mdcolor{purple}\textless{}expr\textgreater{}})\\
\\
{\mdcolor{purple}\textless{}let-assign\textless{}T\textgreater{}\textgreater{}}~::=\\
~~~~\textbar{}~"let"~{\mdcolor{purple}\textless{}var\textgreater{}}~"="~{\mdcolor{purple}\textless{}expr\textgreater{}}~":"~{\mdcolor{purple}\textless{}formula\textless{}T\textgreater{}\textgreater{}}\\
~~~~\textbar{}~"let"~{\mdcolor{purple}\textless{}comma-list(\textless{}var\textgreater{})\textgreater{}}~"="~{\mdcolor{purple}\textless{}comma-list(\textless{}expr\textgreater{})\textgreater{}}\\
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~":"~{\mdcolor{purple}\textless{}formula\textless{}T\textgreater{}\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}equality(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"!="~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"=="~{\mdcolor{purple}\textless{}T\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}order(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"\textgreater{}"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"\textless{}"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"\textless{}="~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"\textgreater{}="~{\mdcolor{purple}\textless{}T\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}bool\textgreater{}}~::=~"("~{\mdcolor{purple}\textless{}bool\textgreater{}}~")"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~"true"\\
~~~~\textbar{}~"false"\\
~~~~\textbar{}~({\mdcolor{purple}\textless{}expr\textgreater{}})~"in"~{\mdcolor{purple}\textless{}set\textgreater{}}\\
~~~~\textbar{}~"subset("~{\mdcolor{purple}\textless{}set\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~"empty("~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}equality(\textless{}int\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}float\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}prop\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}order(\textless{}int\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}float\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}connectors(\textless{}bool\textgreater{})\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}num-operation(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"+"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"-"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~~~~~"-"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"*"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"/"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}num-operation-others(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"mod"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~"abs("~{\mdcolor{purple}\textless{}T\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}int\textgreater{}}~::=\\
~~~~\textbar{}~"("~{\mdcolor{purple}\textless{}int\textgreater{}}~")"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~INT\\
~~~~\textbar{}~num-operation({\mdcolor{purple}\textless{}int\textgreater{}})\\
~~~~\textbar{}~num-operation-others({\mdcolor{purple}\textless{}int\textgreater{}})\\
~~~~\textbar{}~"if"~{\mdcolor{purple}\textless{}bool\textgreater{}}~"then"~{\mdcolor{purple}\textless{}int\textgreater{}}~"else"~{\mdcolor{purple}\textless{}int\textgreater{}}~"end"\\
~~~~\textbar{}~"int("~({\mdcolor{purple}\textless{}int\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}float\textgreater{}})~")"\\
~~~~\textbar{}~"card("~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}float\textgreater{}}~::=\\
~~~~\textbar{}~"("~{\mdcolor{purple}\textless{}float\textgreater{}}~")"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~FLOAT\\
~~~~\textbar{}~num-operation({\mdcolor{purple}\textless{}float\textgreater{}})\\
~~~~\textbar{}~num-operation-others({\mdcolor{purple}\textless{}float\textgreater{}})\\
~~~~\textbar{}~"if"~{\mdcolor{purple}\textless{}bool\textgreater{}}~"then"~{\mdcolor{purple}\textless{}float\textgreater{}}~"else"~{\mdcolor{purple}\textless{}float\textgreater{}}~"end"\\
~~~~\textbar{}~"float("~({\mdcolor{purple}\textless{}int\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}float\textgreater{}})~~")"\\
~~~~\textbar{}~"sqrt("~{\mdcolor{purple}\textless{}float\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}set\textgreater{}}~::=~"("~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~"{}["~{\mdcolor{purple}\textless{}comma-list(\textless{}expr\textgreater{})\textgreater{}}~"]"\\
~~~~\textbar{}~"{}[~{\mdcolor{purple}\textless{}int\textgreater{}}~".."~{\mdcolor{purple}\textless{}int\textgreater{}}~"]"~~~~~~{\mdcolor{darkgreen}\textless{}-~step~is~1}\\
~~~~\textbar{}~"{}[~{\mdcolor{purple}\textless{}float\textgreater{}}~".."~{\mdcolor{purple}\textless{}float\textgreater{}}~"]"~~{\mdcolor{darkgreen}\textless{}-~step~is~1.0}\\
~~~~\textbar{}~"{}[~{\mdcolor{purple}\textless{}expr\textgreater{}}~"for"~{\mdcolor{purple}\textless{}comma-list(\textless{}var\textgreater{})\textgreater{}}\\
~~~~~~~"in"~{\mdcolor{purple}\textless{}comma-list(\textless{}set\textgreater{})\textgreater{}}~{}["when"~{\mdcolor{purple}\textless{}bool\textgreater{}}]~"]"~~{\mdcolor{darkgreen}\textless{}-~TouIST~\textgreater{}=~3.5.2}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}set\textgreater{}}~"inter"~{\mdcolor{purple}\textless{}set\textgreater{}}~~~~~~~~~~{\mdcolor{darkgreen}\textless{}-~TouIST~\textgreater{}=~3.4.0}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}set\textgreater{}}~"union"~{\mdcolor{purple}\textless{}set\textgreater{}}~~~~~~~~~~{\mdcolor{darkgreen}\textless{}-~TouIST~\textgreater{}=~3.4.0}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}set\textgreater{}}~"diff"~{\mdcolor{purple}\textless{}set\textgreater{}}~~~~~~~~~~~{\mdcolor{darkgreen}\textless{}-~TouIST~\textgreater{}=~3.4.0}\\
~~~~\textbar{}~"union("~{\mdcolor{purple}\textless{}set\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~"inter("~{\mdcolor{purple}\textless{}set\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~"diff("~{\mdcolor{purple}\textless{}set\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~"powerset("~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}comma-list(\textless{}T\textgreater{})\textgreater{}}~::=~{\mdcolor{purple}\textless{}T\textgreater{}}~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~","~{\mdcolor{purple}\textless{}comma-list(\textless{}T\textgreater{})\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}generalized-connectors(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~"bigand"~{\mdcolor{purple}\textless{}comma-list(\textless{}var\textgreater{})\textgreater{}}~"in"~{\mdcolor{purple}\textless{}comma-list(\textless{}set\textgreater{})\textgreater{}}\\
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~{}["when"~{\mdcolor{purple}\textless{}bool\textgreater{}}]~":"~{\mdcolor{purple}\textless{}T\textgreater{}}~"end"\\
~~~~\textbar{}~"bigor"~{\mdcolor{purple}\textless{}comma-list(\textless{}var\textgreater{})\textgreater{}}~"in"~{\mdcolor{purple}\textless{}comma-list(\textless{}set\textgreater{})\textgreater{}}\\
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~{}["when"~{\mdcolor{purple}\textless{}bool\textgreater{}}]~":"~{\mdcolor{purple}\textless{}T\textgreater{}}~"end"\\
~~~~\textbar{}~"exact("~{\mdcolor{purple}\textless{}int\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~"atmost("~{\mdcolor{purple}\textless{}int\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
~~~~\textbar{}~"atleast("~{\mdcolor{purple}\textless{}int\textgreater{}}~","~{\mdcolor{purple}\textless{}set\textgreater{}}~")"\\
\\
{\mdcolor{purple}\textless{}connectors(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~~~~~"not"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"and"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"or"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"xor"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"=\textgreater{}"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"\textless{}=\textgreater{}"~{\mdcolor{purple}\textless{}T\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}formula(\textless{}T\textgreater{})\textgreater{}}~::=\\
~~~~\textbar{}~"\textbackslash{}\textbackslash{}"~{\mdcolor{purple}\textless{}T\textgreater{}}~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~"\textbackslash{}\textbackslash{}"~~~~~~~~~~~~~{\mdcolor{darkgreen}\textless{}-~newline~marker~for~latex~display}\\
~~~~\textbar{}~"("~{\mdcolor{purple}\textless{}T\textgreater{}}~")"\\
~~~~\textbar{}~"if"~{\mdcolor{purple}\textless{}bool\textgreater{}}~"then"~{\mdcolor{purple}\textless{}T\textgreater{}}~"else"~{\mdcolor{purple}\textless{}T\textgreater{}}~"end"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}connectors(\textless{}T\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}generalized-connectors(\textless{}T\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}let-assign(\textless{}T\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}T\textgreater{}}~("\textbackslash{}n"\textbar{}"~")~{\mdcolor{purple}\textless{}T\textgreater{}}~~~{\mdcolor{darkgreen}\textless{}-~newline/whitespace~in~top-level~is~an~'and'}\\
\\
{\mdcolor{purple}\textless{}formula-simple\textgreater{}}~::=\\
~~~~\textbar{}~"Top"\\
~~~~\textbar{}~"Bot"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}prop\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}formula(\textless{}formula-simple\textgreater{})\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}formula-smt\textgreater{}}~::=\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}formula(\textless{}formula-smt\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}expr-smt\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}expr-smt\textgreater{}}~::=\\
~~~~\textbar{}~"Top"\\
~~~~\textbar{}~"Bot"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}prop\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}int\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}float\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}order\textgreater{}(\textless{}expr-smt\textgreater{}})\\
~~~~\textbar{}~\textless{}num-operations\_standard({\mdcolor{purple}\textless{}expr-smt\textgreater{})\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}equality(\textless{}expr-smt\textgreater{})\textgreater{}}\\
~~~~\textbar{}~\textless{}in\_parenthesis({\mdcolor{purple}\textless{}expr-smt\textgreater{})\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}formula-qbf\textgreater{}}~::=\\
~~~~\textbar{}~"Top"\\
~~~~\textbar{}~"Bot"\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}prop\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}var\textgreater{}}\\
~~~~\textbar{}~{\mdcolor{purple}\textless{}formula(\textless{}formula-qbf\textgreater{})\textgreater{}}\\
~~~~\textbar{}~"exists"~{\mdcolor{purple}\textless{}comma-list(\textless{}prop\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}var\textgreater{})\textgreater{}}~{}[{\mdcolor{purple}\textless{}for\textgreater{}}]~":"~{\mdcolor{purple}\textless{}formula-qbf\textgreater{}}\\
~~~~\textbar{}~"forall"~{\mdcolor{purple}\textless{}comma-list(\textless{}prop\textgreater{}}\textbar{}{\mdcolor{purple}\textless{}var\textgreater{})\textgreater{}}~{}[{\mdcolor{purple}\textless{}for\textgreater{}}]~":"~{\mdcolor{purple}\textless{}formula-qbf\textgreater{}}\\
\\
{\mdcolor{purple}\textless{}for\textgreater{}}~::=~"for"~{\mdcolor{purple}\textless{}var\textgreater{}}~"in"~{\mdcolor{purple}\textless{}set\textgreater{}}%mdk
\end{mdpre}

\end{footnotesize}